<!DOCTYPE html>  
<html>  
<head>  
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">  
<title>读取Excel数据</title>   
<link rel="stylesheet" href="upload.css">
<script type="text/javascript">  
    function formCheck(form){  
        if(form.excelFile.value == ""){  
            alert("请选择上传的文件");  
            return false;  
        }else{  
            var str= form.excelFile.value;  
            var lc = str.toLowerCase();  
            var arr = lc.split(".");  
            var extname = arr[arr.length-1];  
            if(extname != "xls" && extname != "xlsx"){  
                 alert("请选择excel格式文件！");  
                 return false;  
            }  
        }  
    }  
</script>  
<script src="jquery-1.11.1.js"></script>
<script type="text/javascript">
$(function(){
	$('#btn').click(function(){
		alert("ok");
		$.ajax({
		    url:"/onps/topo/excel.do",
		    type:"post",
		    //dataType:"json",
		    data: new FormData($("#upload_form")[0]),
		    cache: false,
		    processData: false,
		    contentType: false,
		    success: function(data) {
		        console.log(data);    
		    }, 
		    error: function(XMLHttpRequest, textStatus, errorThrown) {
		        alert(XMLHttpRequest.status);
		        alert(XMLHttpRequest.readyState);
		        alert(textStatus);
		    }
		});
	});
});
$(function () {
    $("#topo").click(function () {
        $.ajax({
            url:"/onps/topo/list.do",
            type:"post",
            //dataType:"json",
            //data: new FormData($("#upload_form")[0]),
            cache: false,
            processData: false,
            contentType: false,
            success: function(data) {
                console.log(data);
            },
            error: function(XMLHttpRequest, textStatus, errorThrown) {
                alert(XMLHttpRequest.status);
                alert(XMLHttpRequest.readyState);
                alert(textStatus);
            }
        });
    });
});

</script>
</head>  
<body>
<button id="topo">获取拓扑</button>
<a href="/onps/topo/list.do" download="data.json">下载</a>
<div class="upload_div">
    <span class="close"></span><!-- action="/springMVC_spring_mybatis/excelUpload/importExcel.do" method="post" enctype="multipart/form-data"  -->
    <form id = "upload_form" class="upload_form" name="readExcel" onsubmit="return formCheck(this);">     
        <a href="javascript:;" class="selectBtn btn btn--stripe">
            选择文件
        </a>  
        <input class="select" type="file" name="excelFile"> 
        <p class="file_name">lhhkh.xls</p>
		<button id="btn" class="btn btn--stripe submit " type="button">导入</button>
        <!-- <input id="btn" class="btn btn--stripe submit " type="submit" value="导入">   -->

    </form>  
</div>  
</body>  
<script src="upload.js"></script>

</html> 
